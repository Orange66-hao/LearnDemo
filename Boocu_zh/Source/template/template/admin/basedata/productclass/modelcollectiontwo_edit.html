<script type="text/javascript" src="/adminthemes/new/js/jquery-1.8.3.min.js"></script>
<link href="/adminthemes/css/select2.min.css" rel="stylesheet" />
<script src="/adminthemes/js/select2.min.js"></script>
<script type="text/javascript" src="/adminthemes/js/BooCu.js"></script>
<span style="color: red">* 点击x号删除单个 </span>
<div style="position: absolute;left: 20px;top: 50px" id="my">
    <select class="js-example-basic-multiple" name="states[]" id="select" ></select>
    <input type="button" value="保存修改" onclick="submit()" style="display: block;margin: 0 auto;width: 100px;height: 30px;border-radius: 10px;outline: none;background-color: #00c0ff">
    <script>
        $(document).ready(function() {
            $.ajax({
                url:"/admin/basedata/productclass/expandByChanpinId.jspx?chanpinId="+${chanpinId},
                method:"post",
                dataType:"json",
                success:function (data) {
                    $('.js-example-basic-multiple').select2({
                        width: '800px',
                        placeholder:'请选择',
                        //allowClear:true,
                        dropdownParent:$(document.getElementById("my")),
                        //data:data,
                        //tags: true,
                        multiple:true
                    });
                    $('#select').on('select2:opening', function (e) {
                        e.stopPropagation();
                        return false;
                    });
                    echoSelect2("#select",data);
                }
            })
        });
        function submit() {
            var s = $('#select').select2('data');
            var yiqiIdList=[];
            for(var i=0;i<s.length;i++){
                //console.log("每个仪器Id是"+s[i].id)
                yiqiIdList.push(s[i].id)
            }
            $.ajax({
                url:"/admin/basedata/productclass/addGuanlian.jspx",
                data:{"chanpinid":${chanpinId},"yiqiIdList":yiqiIdList},
                method:"post",
                dataType:"json",
                success:function (rs) {
                    if(rs.type=="success"){
                        alert("修改成功")
                        //关闭这个tab代码    parent.CloseTabByTitle("修改光猫-关联信息")
                        newTab("产品基础数据库","/admin/basedata/productclass/toProductclassAndYiqiList.jspx")

                    }
                }
            })
        }
        //回显数据
        function echoSelect2(dom,value){
            $.each(value,function(index,value){
                $(dom).append(new Option(value.name, value.id, true, true));
            });
            $(dom).trigger("change");
        }
        /* 设置select2选中项不显示 */
    </script>
</div>

