<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="/frontthemes/js/modelcollection.js"></script>
<!--下面两个是品牌选项框提示选择下拉选项的样式-->
<link rel="stylesheet" href="/statics/front/css/postbirdAlertBox.min.css" />
<script type="text/javascript" src="/statics/front/js/postbirdAlertBox.min.js"></script>
<div class="main" style="background-color: white;">
	<div class="easyui-panel" style="border-style: none;">
		<form id="addForm" method="post" class="validate">
			<table>
				<tr>
					<th>公司名</th>
					<td>
						<input class="easyui-validatebox" id="name" name="name" style="width: 308px; height: 36px;"/>
						<span class="rr_model" style="color: red"></span>
					</td>

				</tr>
				<tr>
					<th>公司网站</th>
					<td>
						<input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_website_coll"
							   name="mc_website" data-options="required:false" value=""></input>
					</td>
				</tr>
				<tr>
					<th>行业分类</th>
					<td>
						
						<!-- <select style="width: 308px; height: 36px;"
										class="easyui-combobox"
										 name="mc_industry_class" data-options="url:'/admin/mcIndustyClass/combotreeData.json',valueField:'id',textField:'text',editable:true,multiple:true"
										id="mc_industry_class_coll" /> </select> -->
										<input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_industry_class_coll"
						name="mc_industry_class" data-options="required:false" value=""></input>
										

					</td>
				</tr>
				<tr>
					<th>主营产品名称</th>
					<td>
						<select style="width: 300px; line-height: 36px; height: 36px;"
								name="major_product"
								id="major_product_coll" /> </select>
					</td>
				</tr>
				<tr id="multiple_list">
					<th>仪器品牌</th>
					<td >
						<select style="width: 100px; height: 36px;"  class="easyui-combobox" name="brand" id="brand"></select>
						仪器型号<input class="input_text easyui-validatebox" style="width: 80px;height: 16px" type="text"
								   id="model" name="model" data-options="required:false" onblur="additional(0, null, this, null, null)"/>
						仪器数量<input class="input_text easyui-validatebox" style="width: 80px;height: 16px" type="number" value="1"
								   id="number" name="number" data-options="required:false" onblur="additional(0, null, null, this, null)"/>
						仪器名称<select style="width: 180px; height: 36px;"  class="easyui-combotree" name="mc_productclass_name" id="mc_productclass_name"></select>
						<a href="javascript:void(0)" class="button blueButton"
						   data-options="iconCls:'icon-add',plain:true" onclick="addInput()">再加一个型号</a>
					</td>
					<td><span class="rr_brand_and_model" style="color: red"></span></td>
				</tr>
				<tr>
					<th>订阅内容</th>
					<td>
						<input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="subscribe_content"
								name="subscribe_content" data-options="required:false"></input>
					</td>
				</tr>
				<tr id="trr1" >
					<th id="trr2">联系人</th>
					<td>
					 	<input style="width: 308px; height: 36px;"
										class="easyui-combobox"
										 name="contact" data-options="valueField:'id',textField:'text',multiple:'true',separator:',',editable:false"
										id="contact" required="required"/> 
										
										<!-- <input class="easyui-validatebox" id="contact" name="contact" style="width: 308px; height: 36px;"/> -->
					</td>
				</tr>
				<tr>
					<th>责任人</th>
					<td>
						<select style="width: 308px; height: 36px;"
										class="easyui-combobox"
										url="/admin/mcMember/get_mcmember_names.jspx" name="blame" data-options="multiple:'true',valueField:'id',textField:'text',editable:false"
										id="blame" required="required"/> </select>
						
					</td>
				</tr>
				<tr>
					<th>等级</th>
					<td>
						<select style="width: 308px; height: 36px;" id="grade" name="grade" class="input_text" required="required">
							<option value="1">一级</option>
							<option value="2">二级</option>
							<option value="3">三级</option>
							<option value="4">四级</option>
							<option value="5">五级</option>
							<option value="6">六级</option>
							<option value="7">七级</option>
							<option value="8">八级</option>
							<option value="9"  selected="selected">九级</option>
						</select>
						
					</td>
				</tr>
				<tr>
					<th>计量时间</th>
					<td>
						<select style="width: 308px; height: 36px;" id="measurement_time" name="measurement_time" class="input_text" required="required">
							<option value="1" selected="selected">一月</option>
							<option value="2">二月</option>
							<option value="3">三月</option>
							<option value="4">四月</option>
							<option value="5">五月</option>
							<option value="6">六月</option>
							<option value="7">七月</option>
							<option value="8">八月</option>
							<option value="9">九月</option>
							<option value="10">十月</option>
							<option value="11">十一月</option>
							<option value="12">十二月</option>
						</select>
						
					</td>
				</tr>
				<tr>
					<th>订阅邮件</th>
					<td>
						<select style="width: 308px; height: 36px;" id="ckZt" name="ckZt" class="input_text" required="required">
							<option value="1">是</option>
							<option value="2" selected="selected">否</option>
						</select>
					</td>
				</tr>
				<tr>
					<th>订阅周期</th>
					<td>
						<select style="width: 308px; height: 36px;" id="rate" name="rate" class="input_text" required="required">
							<option value="1">当天</option>
							<option value="7" selected="selected">当周</option>
							<option value="30">当月</option>
						</select>
					</td>
				</tr>
				<tr>
					<th>介绍人</th>
					<td>
										<input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_introducer_coll"
						name="mc_introducer" data-options="required:false" value=""></input>
					</td>
				</tr>
				<tr>
					<th>备注</th>
					<td>
						<input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_remark_coll"
							   name="mc_remark" data-options="required:false" value=""></input>
					</td>
				</tr>
			</table>
			<input type="button"   class="input_text2 easyui-validatebox"   value="添加公司"  onclick="appendmccompanyname()" style="left: 540px;top: 58px;position: absolute;"/>
			<!-- <input type="button"   class="input_text2 easyui-validatebox"   value="添加行业"  onclick="appendmcindustryclass()" style="left: 515px;top: 103px;position: absolute;"/> -->
			<!-- <input type="button"   class="input_text2 easyui-validatebox"   value="添加主营产品"  onclick="appendmcmajor()" style="left: 515px;top: 147px;position: absolute;"/>
			<input type="button"   class="input_text2 easyui-validatebox" id="ddd"  value="添加常用仪器"  onclick="appendmcproductclasstwo()" style="left: 515px;top: 195px;position: absolute;"/> -->
			<!-- <input type="button"   class="input_text2 easyui-validatebox" id="ddd"  value="添加品牌"  onclick="appendmcbrand()" style="left: 515px;top: 240px;position: absolute;"/> -->
			<!--<input type="button"   class="input_text2 easyui-validatebox" id="ddd"  value="添加型号"  onclick="appendmcmodel()" style="left: 540px;top: 280px;position: absolute;"/>-->
			<input type="button"   class="input_text2 easyui-validatebox"   value="添加常用联系人"  onclick="appendcontact()" style="left: 540px;top: 380px;position: absolute;"/>
			<input type="button"   class="input_text2 easyui-validatebox"   value="添加责任人"  onclick="appendmcmember()" style="left: 540px;top: 420px;position: absolute;"/>
		</form>
	</div>
</div>

<script type="text/javascript">
/*    $('#mc_productclass_coll').combotree({/!*data-options="required:false" value="${item.major_product}"*!/
        width:300,
        method:'get',
        url: '/productClass/combotreeData.json',
        multiple: true,
        onlyLeafCheck:true
    });*/

$('#major_product_coll').combotree({
    width:300,
    method:'get',
    onlyLeafCheck:true,
    url: '/industryClass/combotreeData.json',
    multiple: true
});

//下拉树实现自定义查询效果
$('#name').combobox({
    filter: function(q, row){  
        var opts = $(this).combobox('options');  
        return row[opts.textField].indexOf(q) >= 0;//这里改成>=即可在任意地方匹配  
    } 
});  
/* $("#mc_productclass11").combotree({
	checkbox:true,
	multiple:true,
	cascadeCheck:true,
	required:false,
	url:'/admin/basedata/mcproductclass/combotreeData.json',
	onSelect:function(node){
		if(node.attributes.parent_type_id == '0'){
			$("#mc_productclass11").combotree('clear');
			alert('提示',"请选择详细类别");  
			return false;
		}
	}
}); */

 /*    $("#mc_productclass11").combotree({
    	url:'/admin/basedata/mcproductclass/combotreeData.json',
        checkbox: true,
        cascadeCheck: true,
        multiple:true,
        onCheck: function (node, checked) {
            if (checked) {
                var parentNode = $("#mc_productclass11").tree('getParent', node.target);
        	alert(parentNode);
                if (parentNode != null) {
                    $("#mc_productclass11").tree('check', parentNode.target);
                }
            } else {
                var childNode = $("#mc_productclass11").tree('getChildren', node.target);
                if (childNode.length > 0) {
                    for (var i = 0; i < childNode.length; i++) {
                        $("#mc_productclass11").tree('uncheck', childNode[i].target);
                    }
                }
            }
        }
    }); */
	
    
    
    
    
    
	var condition_company=true;
	 $("#name").combobox({
		required:true,
		valueField:'id',
		textField:'text',
		multiple:false,
		editable:true,
		url:'/admin/mcCompanyName/get_mcmember_names.jspx',
		onSelect:function(node){
			$.ajax({
				url:"/admin/ModelCollection/register.jspx",
				data:{name:node.id},
				dataType:"json",
				type:"post",
				success:function(msg){
					if(msg.cont == 'false'){
						$(".rr_model").text('数据已存在，请修改！');
						condition_company=false;
						return false;
					}
					if(msg.cont == 'true'){
						$(".rr_model").text('');
						condition_company=true;
						return true;
					}
				},
				error:function(){
					alert("网络异常,请重试!");
					return false;
				}
			});
            $("#contact").combobox('clear');
            var url ='/admin/mcContacts/get_mcmember_names.jspx?mc_company_id='+node.id;
            $("#contact").combobox('reload',url);//input框中有树方法
            $.ajax({
                //几个参数需要注意一下
                type: "POST",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                url: url ,//url
                success: function (result) {
                    for (var i=0;i<result.length;i++){
                        $("#contact").combobox('select',result[i].id);//input框中有树方法
                    }
                },
                error : function() {
                    alert("添加异常！");
                }
            });

            $("#mc_model_coll").combobox('clear');
            var url1 ='/admin/mcModel/get_mcmember_names.jspx?mc_model_id='+node.id;
            $("#mc_model_coll").combobox('reload',url);//input框中有树方法
            $.ajax({
                //几个参数需要注意一下
                type: "POST",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                url: url1 ,//url
                success: function (result) {
                    for (var i=0;i<result.length;i++){
                        $("#mc_model_coll").combobox('select',result[i].id);//input框中有树方法
                    }
                },
                error : function() {
                    alert("添加异常！");
                }
            });
		}
	});  
	
	/* $("#mc_productclass_coll").combobox({
		onSelect:function(node){
					var id=$("#mc_productclass_coll").combobox('getValues');
					var url ='/admin/mcBrand/get_mcmember_names.jspx?mc_product_id='+id.toString();
					$("#mc_brand_coll").combobox('reload',url);//input框中有树方法

		},
		onUnselect:function(node){
					var id=$("#mc_productclass_coll").combobox('getValues');
					$("#mc_brand_coll").combobox('clear');//刷新前，先清空树
					$("#mc_model_coll").combobox('clear');//刷新前，先清空树
					var url ='/admin/mcBrand/get_mcmember_names.jspx?mc_product_id='+id.toString();
					$("#mc_brand_coll").combobox('reload',url);//input框中有树方法

		}
	});  */
	
	/* $("#mc_brand_coll").combobox({
		onSelect:function(node){
					var id=$("#mc_brand_coll").combobox('getValues');
					var url ='/admin/mcModel/get_mcmember_names.jspx?mc_model_id='+id.toString();
					$("#mc_model_coll").combobox('reload',url);//input框中有树方法

		},
		onUnselect:function(node){
					var id=$("#mc_brand_coll").combobox('getValues');
					$("#mc_model_coll").combobox('clear');//刷新前，先清空树
					var url ='/admin/mcModel/get_mcmember_names.jspx?mc_model_id='+id.toString();
					$("#mc_model_coll").combobox('reload',url);//input框中有树方法

		}
	}); */ 
	
	/* $("#mc_industry_class_coll").combobox({
		onSelect:function(node){
					var id=$("#mc_industry_class_coll").combobox('getValues');
					$("#major_product_coll").combobox('clear');//刷新前，先清空树
				    $("#mc_productclass").combobox('clear');//刷新前，先清空树
					$("#mc_brand").combobox('clear');//刷新前，先清空树
					$("#mc_model").combobox('clear');//刷新前，先清空树 
					var url ='/admin/mcMajor/get_major_names.jspx?mc_industry_id='+id.toString();
					$("#major_product_coll").combobox('reload',url);//input框中有树方法

		},
		onUnselect:function(node){
					var id=$("#mc_industry_class_coll").combobox('getValues');
					$("#major_product_coll").combobox('clear');//刷新前，先清空树
					$("#mc_productclass").combobox('clear');//刷新前，先清空树
					$("#mc_brand").combobox('clear');//刷新前，先清空树
					$("#mc_model").combobox('clear');//刷新前，先清空树 
					var url ='/admin/mcMajor/get_major_names.jspx?mc_industry_id='+id.toString();
					$("#major_product_coll").combobox('reload',url);//input框中有树方法

		}
	});  */
	
/* 	$("#major_product").combobox({
		onSelect:function(node){
					var id=$("#major_product").combobox('getValues');
					var url ='/admin/basedata/mcproductclass/get_mcmember_names.jspx?mc_major_id='+id.toString();
					$("#mc_productclass").combobox('reload',url);//input框中有树方法

		},
		onUnselect:function(node){
					var id=$("#major_product").combobox('getValues');
					$("#mc_productclass").combobox('clear');//刷新前，先清空树
					var url ='/admin/basedata/mcproductclass/get_mcmember_names.jspx?mc_major_id='+id.toString();
					$("#mc_productclass").combobox('reload',url);//input框中有树方法

		}
	});  */
	
</script>
	