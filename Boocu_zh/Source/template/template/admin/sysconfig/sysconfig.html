<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" > </meta>
<title>云图商城-后台管理</title>
<style type="text/css">
body{
	margin:0px;
	font-family:Arial,"宋体",Verdana,sans-serif;
	font-size:12px;
}
</style>
<script type="text/javascript" src="/adminthemes/new/js/jquery-1.8.3.min.js"></script>
<link rel="stylesheet" type="text/css" href="/adminthemes/new/js/easy-ui/themes/gray/easyui.css"/>    
<script type="text/javascript" src="/adminthemes/new/js/easy-ui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/easy-ui/easyui-lang-zh_CN.js"></script>
<link href="/adminthemes/new/css/main.css" rel="stylesheet" type="text/css" />
<script src="/statics/front/js/xcConfirm.js"></script>
<link rel="stylesheet" type="text/css" href="/statics/front/css/xcConfirm.css"/>

[#include '/template/admin/include/common.html']

</head>
<body>
<div id="loading"></div>
<div class="main">
	<div class="easyui-tabs">
		<div title="参数设置" style="padding:10px;">
			<div id="tb" style="height: auto">
				<a href="javascript:void(0)"  class="button blueButton" data-options="plain:true" onclick="initSysConfig()">初始化参数</a>
			</div>
			<div class="clear height10"></div>
			<div>
				<table width="50%" border="1px">
					<tr>
						<td width="100px;">名称</td>
						<td width="100px;">值</td>
						<td width="100px;">操作</td>
					</tr>
					[#list sysCofnigs as list]
					<tr>
						<td>${list.name}</td>
						<td>${list.value}</td>
						<td><a href="javascript:;" onclick="editConfig(${list.id},'${list.name}')">修改</a></td>
					</tr>
					[/#list]
				</table>
			</div>
		</div>
	</div>
	<div id="divdia" style="display:none;rgba(102, 102, 102, 0.08);position:fixed; width:100%; height:100%;left:0px;top:0px;
		z-index:99999999;filter:alpha(opacity=50);-moz-opacity:0.5;-khtml-opacity:0.5;opacity: 0.5;"></div>
	
	<div id="loadbox" style="display:none;position: fixed;left: 40%;top: 30%;background: #FFFFFF;
		overflow: hidden;border-radius: 5px;z-index:999;">
		<div style="background-color: rgba(102, 102, 102, 0.13);"><img src="/statics/front/img/loading4.gif"/></div>
	</div>
</div>

<script type="text/javascript">
function initSysConfig(){
	var txt=  "此操作会将所有系统参数恢复到默认值，请谨慎使用！！！";
	window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.warning,
		{onOk:function(){
		   $("#divdia").show();
		   $("#loadbox").show();	
	       $.get("/sysConfig/initSysConfig.jspx",function(data){
	    	   $("#divdia").hide();
	    	   $("#loadbox").hide();
	    	   if(data=="ok"){
					var txt= "系统参数初始化完成！";
					window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.success,
						{onOk:function(){
							window.location.href="/sysConfig/toSysConfig.jspx";
						}
					});   		   
	    	   }else{
					var txt=  "系统初始化失败，请稍候再重试！";
					window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.error);
	    	   }
	       })
		}
	});
}

function editConfig(id,name){
	window.wxc.xcConfirm(name+"：", window.wxc.xcConfirm.typeEnum.input,{
		onOk:function(val){
			$.post("/sysConfig/updateSysConfig.jspx",
			{"id":id,"value":val},function(data){
				if(data=="ok"){
					window.wxc.xcConfirm("修改成功！", window.wxc.xcConfirm.typeEnum.success,
						{onOk:function(){
							window.location.href="/sysConfig/toSysConfig.jspx";
						}
					});
				}else{
					window.wxc.xcConfirm("修改失败，请稍后再试！", window.wxc.xcConfirm.typeEnum.error);
				}
			})
		}
	});
}
</script>
</body>
</html>