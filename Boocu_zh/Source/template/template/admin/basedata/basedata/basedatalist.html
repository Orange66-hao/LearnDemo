
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" > </meta>
<title>嘉捷惠商城-后台管理</title>
<style type="text/css">
body{
	margin:0px;
	font-family:Arial,"宋体",Verdana,sans-serif;
	font-size:12px;
}
html,body {padding: 0;margin: 0; overflow-x:hidden; overflow-y:auto;}
dl,dd{margin:0px}
ul{
	list-style-type:none;
	margin:0px;
	padding:0px;
}
</style>

<script type="text/javascript" src="/adminthemes/new/js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/jquery-form-2.33.js"></script>
<script type="text/javascript" src="/statics/js/area_sql.js"></script>
<link rel="stylesheet" type="text/css" href="/adminthemes/new/js/easy-ui/themes/gray/easyui.css"/>    
<link rel="stylesheet" type="text/css" href="/adminthemes/new/js/easy-ui/themes/icon.css"/>  
<script type="text/javascript" src="/adminthemes/new/js/easy-ui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/easy-ui/easyui-lang-zh_CN.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/jquery.blockUI.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/jquery.loading.js"></script>
<link href="/adminthemes/new/css/main.css" rel="stylesheet" type="text/css" />
<link href="/adminthemes/new/css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/adminthemes/js/BooCu.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/ajaxupload.3.9.js"></script>
<script type="text/javascript" src="/frontthemes/js/easyuiUtil.js"></script>
[#include '/template/admin/include/common.html']

</head>
<body>
 
<div id="bookinfo" style="display: none;"></div>
<div id="loading"></div>
<div class="main">
<div class="easyui-tabs">
	<div title="审核的资料库列表" style="padding:10px;">
	<form id="memberform">
		<div id="tb" style="height: auto">
		    <a href="javascript:append()" class="button blueButton" 
				data-options="iconCls:'icon-add',plain:true" onclick="appendPro()">添加</a>
		    <a href="javascript:void(0)" class="button blueButton" 
				data-options="iconCls:'icon-add',plain:true" onclick="reject()">反审核</a>
			<a href="javascript:void(0)" class="easyui-linkbutton" id="btnDel"
				data-options="plain:true" onclick="del()">删除</a>
				
			<span style="float: right;">
				<span>
				关键字：
				<input type="text" name="keyword" id="keyword" style="height: 30px">
				</span>
				<span>
				品牌名称：
				<select style="width: 140px; height: 36px;"  class="easyui-combobox" name="brand" id="brand"></select>
				</span>
				<span>
				型号名称：
				<input style="width: 140px; height: 30px;display: inline-block;font-size: 12px"  name="model" id="model"placeholder="请输入型号名称"></input>
					<a href="javascript:void(0)" class="easyui-linkbutton"
					   data-options="plain:true" onclick="searchAdvertBase()">搜索</a>
				</span>
				</span>
			</span>
		</div>
		
		<div class="clear height10"></div>
		<div class="shadowBoxWhite tableDiv">
		<table class="easyui-datagrid"
			data-options="url:'/admin/basedata/basedata/data.json',pageList: [5,10,15,20],pageSize:10,fitColumns:false,nowrap:false"
			pagination="true" id="memberdata" sortName="modifyDate" sortOrder="desc" >
			<thead>
				<tr>
					<th data-options="field:'id',checkbox:true"></th>
					<th data-options="field:'brandId',width:$(this).width()*0.05,sortable:'true'">品牌</th>
					<th data-options="field:'proNo',width:$(this).width()*0.05,sortable:'true'" >型号</th>
					<th data-options="field:'proName',width:$(this).width()*0.05,sortable:'true'" >商品名称</th>
					<th data-options="field:'proNameEn',width:$(this).width()*0.1,sortable:'true'">商品英文名称</th>
					<th data-options="field:'proClassId',width:$(this).width()*0.05,sortable:'true'">商品分类</th>
					<th data-options="field:'industryClass',width:$(this).width()*0.3,sortable:'true'">行业分类</th>
					<th data-options="field:'image',width:$(this).width()*0.08,sortable:'true'" formatter="formatImg" >商品图片</th>
					<th data-options="field:'modify_date',width:$(this).width()*0.1,sortable:'true'" align="center" formatter="formdate" >更新时间</th>
					<th data-options="field:'action',width:$(this).width()*0.1,align:'center'" formatter="formatOperation">操作</th>
				</tr>
			</thead>
		</table>
		</div>
	</form>
	</div>
	<div title="未审核的资料库列表" style="padding:10px;">
		<form id="memberform1">
		<div id="tb" style="height: auto">
<!-- 		    <a href="javascript:append()" class="button blueButton" 
				data-options="iconCls:'icon-add',plain:true" onclick="appendPro1()" >添加</a> -->
			<a href="javascript:void(0)" class="button blueButton" 
				data-options="plain:true" onclick="audit()">审核</a>
			<a href="javascript:void(0)" class="easyui-linkbutton"
				data-options="plain:true" onclick="del1()">删除</a>

			<span style="float: right;">
				<span>
				关键字：
				<input type="text" name="keyword1" id="keyword1" style="height: 30px">
				</span>
				<span>
				品牌名称：
				<select style="width: 140px; height: 36px;"  class="easyui-combobox" name="brand" id="brand1"></select>
				</span>
				<span>
				型号名称：
				<input style="width: 140px; height: 30px;display: inline-block;font-size: 12px"  name="model" id="model1"placeholder="请输入型号名称"></input>
					<a href="javascript:void(0)" class="easyui-linkbutton"
					   data-options="plain:true" onclick="searchAdvertBase1()">搜索</a>
				</span>
				</span>
			</span>
		</div>
		
		<div class="clear height10"></div>
		<div class="shadowBoxWhite tableDiv">
		<table class="easyui-datagrid"
			data-options="url:'/admin/basedata/basedata/nAppr',pageList: [5,10,15,20],pageSize:10,fitColumns:false,nowrap:false"
			pagination="true" id="memberdata1" sortName="modifyDate" sortOrder="desc" >
			<thead>
				<tr>
					<th data-options="field:'id',checkbox:true"></th>
					<th data-options="field:'brandId',width:$(this).width()*0.1,sortable:'true'">品牌</th>
					<th data-options="field:'proNo',width:$(this).width()*0.1,sortable:'true'" >型号</th>
					<th data-options="field:'proName',width:$(this).width()*0.1,sortable:'true'" >商品名称</th>
					<th data-options="field:'proNameEn',width:$(this).width()*0.1,sortable:'true'">商品英文名称</th>
					<th data-options="field:'proClassId',width:$(this).width()*0.1,sortable:'true'">商品分类</th>
					<th data-options="field:'industryClass',width:$(this).width()*0.1,sortable:'true'">行业分类</th>
					<th data-options="field:'image',width:$(this).width()*0.1,sortable:'true'" formatter="formatImg" >商品图片</th>
					<th data-options="field:'modify_date',width:$(this).width()*0.1,sortable:'true'" formatter="formdate" >更新时间</th>
					<th data-options="field:'action',width:$(this).width()*0.1,align:'center'" formatter="formatOperation">操作</th>
				</tr>
			</thead>
		</table>
		</div>
	</form>
	
	</div>
</div>
	<div id="divdia" style="display: none;"></div>
</div>
<script type="text/javascript">
    $("#brand").combobox({
        valueField: 'id',
        textField: 'text',
        url: '/admin/basedata/brand/get_brand_names.jspx',
        required: true,
        multiple: false, //多选
        //editable: false, //是否可编辑
        filter: function (q, row) {
            var opts = $(this).combobox('options');
            return row.text.indexOf(q) >= 0||row.nameEn.toUpperCase().indexOf(q.toUpperCase())>=0;//这里改成>=即可在任意地方匹配
        }
    })
    $("#brand1").combobox({
        valueField: 'id',
        textField: 'text',
        url: '/admin/basedata/brand/get_brand_names.jspx',
        required: true,
        multiple: false, //多选
        //editable: false, //是否可编辑
        filter: function (q, row) {
            var opts = $(this).combobox('options');
            return row.text.indexOf(q) >= 0||row.nameEn.toUpperCase().indexOf(q.toUpperCase())>=0;//这里改成>=即可在任意地方匹配
        }
    })
    function formdate(value, row, index) {
        if(value != null){
            return new Date(value).format("yyyy-MM-dd");
        }

    }
 var map = {};
$(function(){
	map["indexFormId"] = "#memberform";
/* 	//删除设置
	map["delUrl"] = "/admin/basedata/basedata/delete_basedata.jspx";
	map["btnDel"] ="#btnDel"; */
	//增加,修改弹出框设置
	map["tableId"] = "#memberdata";
}); 

function reject(){
	var rows = $("#memberdata").datagrid("getSelections");
	if(rows.length < 1){
		$.Loading.error("请选择要反审核的选项");
		return;
	}
	if(!confirm("确认要反审核该选项?")){
		return;
	}
	var options = {
			url : "/admin/basedata/basedata/reject.jspx?ajax=yes",
			type : "POST",
			dataType : 'json',
			success : function(result) {
				$.Loading.success(result.message);
				if(result.result == 1) {
					var rows = $('#memberdata').datagrid("getSelections");
					for( var i =0; i<rows.length; i++){
						var index = $('#memberdata').datagrid('getRowIndex',
								rows[i]);
						$('#memberdata').datagrid('reload');
					}
				}
			},
			error : function(e) {
				$.Loading.error("出现错误 ，请重试");
			}
		};
		$('#memberform').ajaxSubmit(options);
	}

function audit(){
	var rows = $("#memberdata1").datagrid("getSelections");
	if(rows.length < 1){
		$.Loading.error("请选择要审核的选项");
		return;
	}
	if(!confirm("确认要审核该选项?")){
		return;
	}
	var options = {
			url : "/admin/basedata/basedata/audit.jspx?ajax=yes",
			type : "POST",
			dataType : 'json',
			success : function(result) {
				$.Loading.success(result.message);
				if(result.result == 1) {
					var rows = $('#memberdata1').datagrid("getSelections");
					for( var i =0; i<rows.length; i++){
						var index = $('#memberdata1').datagrid('getRowIndex',
								rows[i]);
						$('#memberdata1').datagrid('reload');
					}
				}
			},
			error : function(e) {
				$.Loading.error("出现错误 ，请重试");
			}
		};
		$('#memberform1').ajaxSubmit(options);
	}

function del() {
	var rows = $("#memberdata").datagrid("getSelections");
	if(rows.length < 1){
		$.Loading.error("请选择要删除的选项");
		return;
	}
	if(!confirm("确认要删除该选项?")){
		return;
	}
	var options = {
			url: "/admin/basedata/basedata/delete_basedata.jspx?ajax=yes",
			type : "POST",
			dataType: 'json',
			success : function(result) {
				$.Loading.success(result.message);
				if(result.result == 1) {
					var rows = $('#memberdata').datagrid("getSelections");
                        for( var i =0; i<rows.length; i++){
						var index = $('#memberdata').datagrid('getRowIndex',
								rows[i]);
						$('#memberdata').datagrid('deleteRow',index);
					}
				}
			},
			error : function(e){
				$.Loading.error("出现错误, 请重试");
			}
			};	
	$('#memberform').ajaxSubmit(options);
}

function del1() {
	var rows = $("#memberdata1").datagrid("getSelections");
	alert(1);
	if(rows.length < 1){
		$.Loading.error("请选择要删除的选项");
		return;
	}
	if(!confirm("确认要删除该选项?")){
		return;
	}
	var options = {
			url: "/admin/basedata/basedata/delete_basedata.jspx?ajax=yes",
			type : "POST",
			dataType: 'json',
			success : function(result) {
				$.Loading.success(result.message);
				if(result.result == 1) {
					var rows = $('#memberdata1').datagrid("getSelections");
					for( var i =0; i<rows.length; i++){
						var index = $('#memberdata1').datagrid('getRowIndex',
								rows[i]);
						$('#memberdata1').datagrid('deleteRow',index);
					}
				}
			},
			error : function(e){
				$.Loading.error("出现错误, 请重试");
			}
			};	
	$('#memberform1').ajaxSubmit(options);
}
function appendPro(){
	newTab( "资料新增","/admin/basedata/basedata/add_basedata.jspx");
}
function formatOperation(value, row, index) {
	var val = "<a class='edit' title='修改' href='javascript:void(0);' onclick='newTab(\""
		+ row.proName
		+ "-信息修改\",\"/admin/basedata/basedata/edit_basedata.jspx?id="
		+ row.id+"\")' ></a>";
	return val;
}

//关键字搜索
function searchAdvertBase() {
    var keyword = $("#keyword").val();
	var model = $("#model").val();
    var brandId = $("#brand").combobox('getValue');
	$("#memberdata").datagrid("load", {
	    keyword:keyword,
		model:model,
		brandId:brandId,
		page:1
	});
	
}

//未审核搜索
function searchAdvertBase1() {
    var keyword1 = $("#keyword1").val();
    var model1 = $("#model1").val();
    var brandId1 = $("#brand1").combobox('getValue');
    $("#memberdata1").datagrid("load", {
        keyword:keyword1,
        model:model1,
        brandId:brandId1,
        page:1
    });
}
</script>
</body>
</html>