
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" > </meta>
<title>嘉捷惠商城-后台管理</title>
<style type="text/css">
body{
	margin:0px;
	font-family:Arial,"宋体",Verdana,sans-serif;
	font-size:12px;
}
html,body {padding: 0;margin: 0; overflow-x:hidden; overflow-y:auto;}
dl,dd{margin:0px}
ul{
	list-style-type:none;
	margin:0px;
	padding:0px;
}
</style>

<script type="text/javascript" src="/adminthemes/new/js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/jquery-form-2.33.js"></script>
<script type="text/javascript" src="/statics/js/area_sql.js"></script>
<link rel="stylesheet" type="text/css" href="/adminthemes/new/js/easy-ui/themes/gray/easyui.css"/>    
<link rel="stylesheet" type="text/css" href="/adminthemes/new/js/easy-ui/themes/icon.css"/>  
<script type="text/javascript" src="/adminthemes/new/js/easy-ui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/easy-ui/easyui-lang-zh_CN.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/jquery.blockUI.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/jquery.loading.js"></script>
<link href="/adminthemes/new/css/main.css" rel="stylesheet" type="text/css" />
<link href="/adminthemes/new/css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/adminthemes/js/BooCu.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/ajaxupload.3.9.js"></script>
<script type="text/javascript" src="/frontthemes/js/easyuiUtil.js"></script>
[#include '/template/admin/include/common.html']

</head>
<body>
 
<div id="bookinfo" style="display: none;"></div>
<div id="loading"></div>
<div class="main">
	<form id="memberform">
		<div id="tb" style="height: auto">
			<select id="columnSel" style="width:150px"></select>
		    <a href="javascript:append()" class="button blueButton" 
				data-options="iconCls:'icon-add',plain:true" onclick="appendPro()" >添加</a>
			<a href="javascript:void(0)" class="easyui-linkbutton"
				data-options="plain:true" onclick="del(map)">删除</a>
				
			<span style="float: right;"> 
				<input class="easyui-combobox combo " type="text" id="brand"
						name="brandId" data-options="url:'/admin/basedata/brand/get_brand_names.jspx',method:'get',valueField:'id',textField:'text', width:300 "  ></input>
				<span id="simpleSearch">
					<input id="searchKeyword" class="input_text" type="text" value="" size="30" style="width: 300px;"
					placeholder="请输入商品名称,类型" name="searchKeyWord"> 
					<a href="javascript:void(0)" class="easyui-linkbutton" 
					data-options="plain:true" onclick="searchAdvertBase()">搜索</a>
				</span>
			</span>
		</div>
		
		<div class="clear height10"></div>
		<div id="Columnns">
			 <div style="color:#99BBE8;background:#fafafa;padding:5px;">请选择要动态生成的列</div>
			
		</div>
		<div class="shadowBoxWhite tableDiv">
		<table class="easyui-datagrid"
			data-options="url:'/admin/prodoctMng/cusProMng/wantRepair/data.json',pageList: [5,10,15,20],pageSize:10,fitColumns:'false'"
			pagination="true" id="memberdata" sortName="id" sortOrder="desc" >
			<thead>
				<tr>
					<th data-options="field:'item.id',checkbox:true">id</th>
					<th data-options="field:'item.productEntity.proName',hidden:'true',sortable:'true' ">商品名称</th>
					<th data-options="field:'item.productEntity.productBrandEntity.name',hidden:'true' " >品牌</th> 
					<th data-options="field:'item.productEntity.productclass.name',sortable:'true'" >商品分类</th>
					<th data-options="field:'item.productEntity.industryClassEntity.name',sortable:'true'" >所属行业</th>
					<th data-options="field:'item.productEntity.productType.typeName',hidden:'true',sortable:'true'" >商品类型</th>
					<th data-options="field:'item.productEntity.proNo',hidden:'true' ">商品型号</th>
					<th data-options="field:'item.repairPrice',hidden:'true' ,sortable:'true' ">预算价格</th>
					<th data-options="field:'item.repairPriceUnit',hidden:'true' " formatter="priceUnitFormatter">预算价格单位</th>
					<th data-options="field:'item.repairPriceType',hidden:'true' " formatter ="priceTypeFormatter">预算价格币种</th>
					<th data-options="field:'item.productEntity.prodNumber',hidden:'true' ">机身号码</th>
					<th data-options="field:'item.productEntity.poption',hidden:'true' ">选件</th>
					<th data-options="field:'item.productEntity.proNameEn',hidden:'true' ">英文名称</th>
					<th data-options="field:'item.productEntity.proownaudit',hidden:'true' ">是否上架</th>
					<th data-options="field:'item.productEntity.proStock',hidden:'true' ">数量</th>
					<th data-options="field:'item.productEntity.procostPrice',hidden:'true' ">设备价值</th>
					<th data-options="field:'item.productEntity.qualityStatus',hidden:'true' ">成色</th>
					<th data-options="field:'item.productEntity.referencePrice',hidden:'true' ">全新参考价</th>
					<th data-options="field:'item.productEntity.referencepricetype',hidden:'true' ">全新参考价单位</th>
					<th data-options="field:'item.productEntity.referencePriceLimit',hidden:'true' ">全新参考价币别</th>
					<th data-options="field:'item.productEntity.status',hidden:'true' ">产品状态</th>
					<th data-options="field:'item.productEntity.isTax',hidden:'true' ">是否含税</th>
					<th data-options="field:'item.productEntity.taxRate',hidden:'true' ">税率</th>
					<th data-options="field:'item.productEntity.isUnit',hidden:'true' ">是否可计量</th>
					<th data-options="field:'item.productEntity.proUnit',hidden:'true' ">计量单位</th>
					<th data-options="field:'item.productEntity.cycle',hidden:'true' " >交货周期</th>
					<th data-options="field:'item.productEntity.cycleUnit',hidden:'true' ">交货周期单位</th>
					<th data-options="field:'item.productEntity.prouseAddress',hidden:'true' ">所在地</th>
				<!-- 	<th data-options="field:'item.productEntity.areaEntity.fullName',hidden:'true' ">省</th>
					<th data-options="field:'item.productEntity.areaEntity.fullName',hidden:'true' ">州市</th>
					<th data-options="field:'item.productEntity.areaEntity.fullName',hidden:'true' ">县区</th> -->
					<th data-options="field:'item.productEntity.proAddressDetail',hidden:'true' ">详细地址</th>
					<th data-options="field:'item.productEntity.repairPeriod',hidden:'true' ">保修时间</th>
					<th data-options="field:'item.productEntity.repairPeriodUnit',hidden:'true' ">保修时间单位</th>
					<th data-options="field:'item.productEntity.proOriginal1',hidden:'true'">图片1</th>
					<th data-options="field:'item.productEntity.proOriginal2',hidden:'true'">图片2</th>
					<th data-options="field:'item.productEntity.proOriginal3',hidden:'true'">图片3</th>
					<th data-options="field:'item.productEntity.proOriginal4',hidden:'true'">图片4</th>
					<th data-options="field:'item.productEntity.downData',hidden:'true' ">资料下载</th>
					<th data-options="field:'item.productEntity.proSynopsis ',hidden:'true' ">产品描述</th>
					<th data-options="field:'item.productEntity.proSynopsisEn',hidden:'true' ">产品描述英文</th>
					<th data-options="field:'item.productEntity.proContent',hidden:'true' ">详细信息</th>
					<th data-options="field:'item.productEntity.proContentEn',hidden:'true' ">详细信息英文</th>
					<th data-options="field:'item.productEntity.apply',hidden:'true' ">行业应用</th>
					<th data-options="field:'item.productEntity.applyEn',hidden:'true' ">行业应用英文</th>
					<th data-options="field:'item.productEntity.prometaTitle',hidden:'true' ">优化标题</th>
					<th data-options="field:'item.productEntity.proMetaKeywords',hidden:'true' ">优化关键字</th>
					<th data-options="field:'item.productEntity.prometaDescription',hidden:'true' ">优化描述</th>
					<th data-options="field:'item.productEntity.remain',hidden:'true' ">备注</th>
					<th data-options="field:'item.productEntity.webzh',hidden:'true' ">webzh</th>
					<th data-options="field:'item.productEntity.weben',hidden:'true' ">weben</th> 
					<th data-options="field:'item.productEntity.apprStatus',hidden:'true' " formatter="apprFormatter">状态</th> 
					<th data-options="field:'item.productEntity.remark',hidden:'true' ">驳回原因</th> 
					<th data-options="field:'item.maintainPeriod',hidden:'true' ">维修周期</th> 
					<th data-options="field:'item.maintainPeriodunit',hidden:'true'  " formatter ="dateTypeFormatter">维修周期单位</th> 
					<th data-options="field:'item.fault',hidden:'true' ">常见故障</th> 
					<th data-options="field:'item.fault',hidden:'true' ">常见故障英文</th> 
					<th data-options="field:'item.bugloko',hidden:'true' ">故障现象</th> 
					<th data-options="field:'item.buglokoEn',hidden:'true' ">故障现象英文</th> 
					<th data-options="field:'item.faultCause',hidden:'true' ">故障原因</th> 
					<th data-options="field:'item.faultCauseEn',hidden:'true' ">故障原因英文</th> 
					<th data-options="field:'item.maintenanceEngineerAddress',hidden:'true' ">维修所在地</th>
					<th data-options="field:'item.productEntity.memberEntity.username',hidden:'true'  ">会员名</th> 
					<th data-options="field:'action',align:'center'" formatter="formatEdit">操作</th>
				</tr>
			</thead>
		</table>
		</div>
	</form>
	<div id="divdia" style="display: none;"></div>

</div>
<script type="text/javascript">
	var map = {};
	var columesCheckedArr = [0,1,2,3,4,5,6,,7,8,9,59,60];
	$(function(){
		//初始化列名下拉
		initColumSel();
		//初始化列名显示
		showColumn();
		
		map["indexFormId"] = "#memberform";
		//删除设置
		map["delUrl"] = "/admin/prodoctMng/cusProMng/wantRepair/delete_cusPubWantRepair.jspx";
		map["tableId"] = "#memberdata";
		
		//品牌下拉事件
		$("#brand").combobox({
			onChange:function(id,e){
				/* var fields = $("#memberdata").datagrid('getColumnFields');
				$("#memberdata").datagrid("hideColumn",fields[2]); */
				var keyword = $("#searchKeyword").val();
				$("#memberdata").datagrid("load",{
					brandId:id,
					keyword:keyword,
					page:1
				});
			}
		});
		
		//动态选择列
		$("#Columnns").find("input:checkbox").on("change",function(){
			var val = $(this).val();
			var columesCheckedArrNew = [];
			$("#Columnns").find("input:checkbox[checked=checked]").each(function(){
				columesCheckedArrNew.push($(this).val());
			});
			columesCheckedArr = columesCheckedArrNew;
			showColumn();
		});
	});
	
	function showColumn(){
		var fields = $("#memberdata").datagrid('getColumnFields');
		//隐藏所有列
		for(var index in fields){
			$("#memberdata").datagrid('hideColumn',fields[index]);
		}
		for(var index in columesCheckedArr){
			$("#memberdata").datagrid('showColumn',fields[columesCheckedArr[index]]);
			$("#Columnns").find("input:checkbox[value='"+columesCheckedArr[index]+"']").attr("checked","checked");
		}
	}
	
	function initColumSel(){
		//初始化列名下拉数据
		$("#columnSel").combo({
			require:true,
			editable:false
		});
		var index = 0;
		$("#memberdata thead").find("th").each(function(){
			var text = $(this).text();
			$("#Columnns").append('<input type="checkbox" value="'+index+'"  ><span>'+text+'</span><br/>');
			index++;
		});
		$("#Columnns").appendTo($("#columnSel").combo("panel"))
		
	}
	
	function apprFormatter(value,row,index){
		var arr = ["未审核","已审核","被驳回"];
		return arr[value] ;
	}
	function priceUnitFormatter(value,row,index){
		return value == "yuan"? "元":"万元";
	}
	function priceTypeFormatter(value,row,index){
		return value=="rmb"?"人民币":"美元";
	}
	function dateTypeFormatter(value,row,index){
		return "day" == value ?"天":("week"==value?"周":"月");
	}
	function searchAdvertBase(){
		var keyword = $("#searchKeyword").val();
		$("#memberdata").datagrid("load",{
			keyword:keyword,
			page:1
		});
	}
	function appendPro(){
		newTab( "产品求修新增","/admin/prodoctMng/cusProMng/wantRepair/add_cusPubWantRepair.jspx");
	}
	function formatEdit(value, row, index) {
		var val = "<a class='edit' title='修改' href='javascript:void(0);' onclick='newTab(\""
			+ row.item.productEntity.proName
			+ "-信息修改\",\"/admin/prodoctMng/cusProMng/wantRepair/edit_cusPubWantRepair.jspx?id="
			+ row.item.id + "\")' ></a>";
		return val;
	}
	
</script>
</body>
</html>