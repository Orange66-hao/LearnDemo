<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" > </meta>
<title>云图商城-后台管理</title>
<style type="text/css">
body{
	margin:0px;
	font-family:Arial,"宋体",Verdana,sans-serif;
	font-size:12px;
}
html,body {padding: 0;margin: 0; overflow-x:hidden; overflow-y:auto;}
dl,dd{margin:0px}
ul{
	list-style-type:none;
	margin:0px;
	padding:0px;
	
}
</style>
<script type="text/javascript" src="/adminthemes/new/js/jquery-1.8.3.min.js"></script>
<link rel="stylesheet" type="text/css" href="/adminthemes/new/js/easy-ui/themes/gray/easyui.css"/>    
<link rel="stylesheet" type="text/css" href="/adminthemes/new/js/easy-ui/themes/icon.css"/>  
<script type="text/javascript" src="/adminthemes/new/js/easy-ui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/easy-ui/easyui-lang-zh_CN.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/jquery.blockUI.js"></script>
<script type="text/javascript" src="/adminthemes/new/js/jquery.loading.js"></script>
<link href="/adminthemes/new/css/main.css" rel="stylesheet" type="text/css" />
<link href="/adminthemes/new/css/style.css" rel="stylesheet" type="text/css" />
<link href="/statics/css/daterangepicker.css" rel="stylesheet" type="text/css" />
<script src="/statics/js/moment.min.js"></script>
<script src="/statics/js/jquery.daterangepicker.js"></script>
<script src="/statics/js/highcharts.js"></script>
<script src="/statics/js/exporting.js"></script>
<script type="text/javascript">
$(function () {
	loadData(1,"container1");
	loadData(2,"container2");
	loadData(3,"container3");
	loadData(4,"container4");
	loadData(5,"container5");
	loadData(6,"container6");
	loadData(7,"container7");
	loadData(8,"container8");
	loadData(11,"container11");
	loadData(12,"container12");
	loadData(13,"container13");
});

function loadData(group,container){
	$.ajax({
		url : "/stat/lvSubScript.json",
		type : "POST",
		dataType : "JSON",
		data : {"type":2,"group":group},
		async: false,
		success:function(data){
			var proNo= data.subName.split(",");
			var proVal = data.subVal.split(",");
			var val = new Array();
			for(var i = 0;i < proVal.length;i++){
				val[i] = parseInt(proVal[i]);
			}
			var charts;
			charts = new Highcharts.Chart({
			//$(container).highcharts({
		        chart: {
		        	renderTo: container,
		            zoomType: 'xy'
		        },
		        title: {
		        	text: '订阅最多的产品分类'
		        },
		        xAxis: [{
		            categories: proNo,
		            crosshair: true
		        }],
		        yAxis: [{ // Primary yAxis
		            title: {
		                text: '数量',
		                style: {
		                    color: Highcharts.getOptions().colors[1]
		                }
		            }
		        }, { // Secondary yAxis
		        }],
		        tooltip: {
		            shared: true
		        },
		        credits: {enabled: false},
		        series: [{
		            name: '浏览次数',
		            type: 'column',
		            yAxis: 1,
		            data: val,
		            tooltip: {
		                valueSuffix: '次'
		            }
		        }]
			});
		}
	});
}
</script>
[#include '/template/admin/include/common.html']

</head>
<body>
<div id="loading"></div>
<div class="main">
	<div class="easyui-tabs">
		<div title="销售" style="padding:10px;">
			<div class="clear height10"></div>
			<form id=saleSearch>
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span>
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(1)">下载</a>
						</span>
					</span>
				</div>
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container1" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=1'" pagination="false" id="saleList">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div title="求购" style="padding:10px;">
			<div class="clear height10"></div>
			<form id="buySearch">
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span>
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(2)">下载</a>
						</span>
					</span>
				</div>
				
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container2" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=2'" pagination="false" id="buyList">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div title="出租" style="padding:10px;">
			<div class="clear height10"></div>
			<form id="rentSearch">
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span>
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(3)">下载</a>
						</span>
					</span>
				</div>
				
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container3" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=3'" pagination="false" id="rentList">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div title="求租" style="padding:10px;">
			<div class="clear height10"></div>
			<form id="wantRentSearch">
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span>
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(4)">下载</a>
						</span>
					</span>
				</div>
				
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container4" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=4'" pagination="false" id="wantRentList">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div title="维修" style="padding:10px;">
			<div class="clear height10"></div>
			<form id="repairSearch">
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span>
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(5)">下载</a>
						</span>
					</span>
				</div>
				
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container5" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=5'" pagination="false" id="repairList">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div title="求修" style="padding:10px;">
			<div class="clear height10"></div>
			<form id="wantRepairSearch">
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span id="simpleSearch">
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(6)">下载</a>
						</span>
					</span>
				</div>
				
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container6" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=6'" pagination="false" id="wantRepairList">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div title="自动化测试方案" style="padding:10px;">
			<div class="clear height10"></div>
			<form id="wantRepairSearch">
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span id="simpleSearch">
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(7)">下载</a>
						</span>
					</span>
				</div>
				
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container6" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=7'" pagination="false" id="autoPro">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div title="自动化测试需求" style="padding:10px;">
			<div class="clear height10"></div>
			<form id="wantRepairSearch">
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span id="simpleSearch">
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(8)">下载</a>
						</span>
					</span>
				</div>
				
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container6" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=8'" pagination="false" id="autoReq">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div title="产品测试" style="padding:10px;">
			<div class="clear height10"></div>
			<form id="wantRepairSearch">
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span id="simpleSearch">
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(11)">下载</a>
						</span>
					</span>
				</div>
				
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container6" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=11'" pagination="false" id="proTest">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div title="测试需求" style="padding:10px;">
			<div class="clear height10"></div>
			<form id="wantRepairSearch">
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span id="simpleSearch">
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(12)">下载</a>
						</span>
					</span>
				</div>
				
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container6" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=12'" pagination="false" id="testReq">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div title="计量校准" style="padding:10px;">
			<div class="clear height10"></div>
			<form id="wantRepairSearch">
				<div id="tb" style="height: auto">
					<span style="float: left;"> 
						<span id="simpleSearch">
							<a href="javascript:;" class="easyui-linkbutton" data-options="plain:true" onclick="downLoadExcel(13)">下载</a>
						</span>
					</span>
				</div>
				
				<div class="clear height10"></div>
				<div class="shadowBoxWhite tableDiv"></div>
			</form>
			<div id="container6" style="min-width: 310px; height: 400px; margin: 0 auto;width: 100%"></div>
			<div class="shadowBoxWhite tableDiv">
				<table class="easyui-datagrid"
					data-options="url:'/stat/loadSubscript.json?type=2&group=13'" pagination="false" id="equals">
					<thead>
						<tr>
						 	<th data-options="field:'name',width:200,align:'center'" >分类名称</th>
						 	<th data-options="field:'userCount',width:100,align:'center'" >订阅用户数</th>
						 	<th data-options="field:'emailRecv',width:100,align:'center'" >邮箱接收用户数</th>
							<th data-options="field:'systemRecv',width:100,align:'center'">系统接收用户数</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
function downLoadExcel(group){
	window.location.href="/stat/exportSubExcel.jspx?type=2&group="+group;
	//window.location.href="/stat/exportExcel.jspx?type="+type+"&group=2";
}
</script>
</body>
</html>