<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<meta charset="utf-8">
<title>订阅中心 - 晧辰仪联网</title>
<link rel="stylesheet" href="/statics/front/css/public.css" />
<link rel="stylesheet" href="/statics/front/css/info.css" />
<link rel="stylesheet" type="text/css"
	href="/adminthemes/new/js/easy-ui/themes/gray/easyui.css" />
<link rel="stylesheet" type="text/css"
	href="/adminthemes/new/js/easy-ui/themes/icon.css" />
[#include '/template/front/include/csslist.html' /]

</head>
<body>
	<!--top-->
	<div class="toplogind">
		<div class="main">
			<div class="logod">
				<a href="/index.html"><img src="/statics/front/images/logo.png"></a>
			</div>
			<div class="titd">订阅中心</div>
		</div>
	</div>
	<!--./top-->

	<!--content-->
	<div class="subscd">
		<div class="cond1">
			<p>邮件地址：${currentMember.email}</p>
			<p>公司名称：${currentMember.coName}</p>
			<p>联系人：${currentMember.realName}</p>
			<p>电话：${currentMember.mobile}</p>
		</div>
		<!--./cond1-->

		<div class="cond2">
			<p>
				<a href="javascript:menuClick(1);"><img
					src="/statics/front/images/m3_1.jpg" title="请点击"></a>
			</p>
			<p>
				<a href="javascript:menuClick(2);"><img
					src="/statics/front/images/m3_2.jpg" title="请点击"></a>
			</p>
			<p>
				<a href="javascript:menuClick(3);"><img
					src="/statics/front/images/m3_3.jpg" title="请点击"></a>
			</p>
		</div>
		<!--./cond2-->
		<!-- <form action="/subscribe/addsubscribe.jspx" method="post" id="subscribeFrom"> -->
		<div class="cond3">
			<div class="titd">您的常用仪器</div>
			<div class="depd">根据您的注册信息，匹配出您可能感兴趣的仪器</div>
			<ul id="show">
				[#list items as product]
				<li><label> <input type="checkbox" name="ckyq"
						va="${product.id}" value="${product.id}">${product.productBrandEntity.name}
						${product.proNo} ${product.proName}
				</label></li> [/#list]
			</ul>
		</div>

		<div class="cond4">
			<div class="searchd">
				<p class="txtd">
					<input type="text" name="keyword" id="txtPname" class="txt"
						placeholder="请输入商品名称、型号等关键字">
				</p>
				<p class="btnd" id="btnd">
					<a href="javascript:;">搜一下</a>
				</p>
			</div>

			<div class="slistd"></div>
			<div class="seluld">
				<div class="name">已选条件：</div>
			</div>
			<!--./slistd-->

		</div>
		<!--./cond4-->

		<div class="cond5">
			<div class="titd">信息类别：</div>
			<ul>
				<li><label> <input type="checkbox" name="proType"
						 value="1"> 销售
				</label> <br> <label> <input type="checkbox" name="proType"
						 value="2"> 求购
				</label></li>
				<li><label> <input type="checkbox" name="proType"
						 value="3"> 租凭
				</label> <br> <label> <input type="checkbox" name="proType"
						 value="4"> 求租
				</label></li>
				<li><label> <input type="checkbox" name="proType"
						 value="5"> 维修
				</label> <br> <label> <input type="checkbox" name="proType"
						 value="6"> 求修
				</label></li>
				<li><label> <input type="checkbox" name="proType"
						 value="7"> 自动化测试方案
				</label> <br> <label> <input type="checkbox" name="proType"
						 value="8"> 自动化测试需求
				</label></li>
				<li><label> <input type="checkbox" name="proType"
						 value="9"> 拍卖
				</label> <br> <label> <input type="checkbox" name="proType"
						 value="10"> 招标
				</label></li>
				<li><label> <input type="checkbox" name="proType"
						 value="11"> 产品测试
				</label> <br> <label> <input type="checkbox" name="proType"
						 value="12"> 测试需求
				</label></li>
				<li></li>
				<li><br> <label> <input type="checkbox"
						name="proType" id="proType" value="13"> 计量校准
				</label></li>
			</ul>
			<div class="infoul1">
				<p class="w">订阅信息接收载体：</p>
				<p>
					<label> <input type="checkbox" name="model"
						value=0 checked> 用户中心查看
					</label>
				</p>
				<p>
					<label> <input type="checkbox" name="model"
						value=1 checked> 邮件接收
					</label>
				</p>
			</div>
			<!--./infoul1-->
			<div class="infoul1">
				<p class="w">信息收接频率：</p>
				<p>
					<label> <input type="radio" name="rate" value=1>
						每天一次
					</label>
				</p>
				<p>
					<label> <input type="radio" name="rate" value=2>
						每周一次
					</label>
				</p>
				<p>
					<label> <input type="radio" name="rate" value=3 checked>
						每月一次
					</label>
				</p>
			</div>
			<!--./infoul1-->

			<div class="btnd" id="subbtn">
				<a href="javascript:;">提 交</a>
			</div>
		</div>
		<!--./cond5-->
		<div class="cond6">
			<h3>订阅说明：</h3>
			<p>1、订阅内容全部免费，定期更新；</p>
			<p>2、您可以点击产品类别、行业分类或者常用仪器图标进行订阅；</p>
			<p>3、订阅后，所需内容将以邮件形式发送至您的“邮件订阅”文件夹和邮箱中。</p>
		</div>
		<!--./cond6-->
		<!-- </form> -->
	</div>
	<!--./content-->

	<!--foot-->
	<div class="footd">
		<div class="main">
			<div class="fcontd">
				<p>
					Copyright &copy; 2007 All Rights Reserved. 深圳市晧辰电子科技有限公司
					版权所有&nbsp;&nbsp;<a href="#" target="_blank">[粤ICP备14101712号-1]</a>&nbsp;<a
						href="#" target="_blank">[法律顾问]</a>
				</p>
				<p>公司地址：广东省深圳市南山区西丽街道牛成路221号8楼&nbsp;&nbsp;邮编：518055</p>
				<p>
					在线QQ服务：<a href="#"><img src="/statics/front/images/fico0.png"></a>&nbsp;&nbsp;服务热线：0755－86016691&nbsp;&nbsp;电话：13715327187&nbsp;&nbsp;传真：0755-86641139-816
				</p>
				<p>E-mail：info@wl95.com</p>
			</div>
			<div class="fimgd">
				<a href="#" target="_blank"><img
					src="/statics/front/images/fico1.png"></a><a href="#"
					target="_blank"><img src="/statics/front/images/fico2.png"></a><a
					href="#" target="_blank"><img
					src="/statics/front/images/fico3.png"></a><a href="#"
					target="_blank"><img src="/statics/front/images/fico4.png"></a>
			</div>
		</div>
	</div>
	<!--./foot-->
	<script type="text/javascript"
		src="/adminthemes/new/js/jquery-1.8.3.min.js"></script>
	<script type="text/javascript"
		src="/adminthemes/new/js/jquery-form-2.33.js"></script>
	<script type="text/javascript" src="/statics/js/area_sql.js"></script>

	<script type="text/javascript"
		src="/adminthemes/new/js/easy-ui/jquery.easyui.min.js"></script>
	<script type="text/javascript"
		src="/adminthemes/new/js/easy-ui/easyui-lang-zh_CN.js"></script>
	<script type="text/javascript"
		src="/adminthemes/new/js/jquery.blockUI.js"></script>
	<script type="text/javascript"
		src="/adminthemes/new/js/jquery.loading.js"></script>

	<script type="text/javascript" src="/adminthemes/js/BooCu.js"></script>
	<script type="text/javascript"
		src="/adminthemes/new/js/ajaxupload.3.9.js"></script>
	<script type="text/javascript" src="/frontthemes/js/easyuiUtil.js"></script>
	<script type="text/javascript">
		menuClick(1);
		function menuClick (i)
        {
	        $ (".seluld .wlid").remove ();
	        if (i == 3)
	        {
		        $ (".cond3").show ();
		        $ (".searchd").show ();
		        $ ("#show").html ("");
		        $ (".slistd").html ("");
		        $.ajax (
		                {
		                    url : '/subscribe/toTopList.jspx',
		                    type : "post",
		                    success : function (result)
		                    {
			                    $.each (
			                                    result,
			                                    function (e)
			                                    {
				                                    $ ("#show")
				                                            .append (
				                                                    '<li><label> <input type="checkbox" name="ckyq" va='
											+ result[e].id + ' value='
											+ result[e].id + '>'
				                                                            + result[e].text + '</label></li>');
			                                    });
			                    $ ("#show").find ("[name=ckyq]").bind ('click', function ()
			                    {
				                    if ($ (this).attr ("checked"))
				                    {
					                    $ (".seluld").append (dataHtml ($ (this).val (), $ (this).parent ().text ()));
					                    $ (".ico").bind ('click', function ()
					                    {
						                    var id = $ (this).parent ().attr ("va");
						                    $ ("[va=" + id + "]").attr ("checked", false);
						                    $ (this).closest (".wlid").remove ();
						                    
					                    });
				                    }
				                    else
				                    {
					                    var id = $ (this).attr ("va");
					                    $ (".wlid[va='" + id + "']").remove ();
				                    }
			                    });
		                    }
		                })
	        }
	        if (i == 2)
	        {
		        $ (".cond3").hide ();
		        $ (".searchd").hide ();
		        $.ajax (
		        {
		            url : '/subscribe/toIndustryClass.jspx',
		            type : 'post',
		            success : function (data)
		            {
			            $ ('.slistd').html (data);
		            }
		        });
	        }
	        if (i == 1)
	        {
		        $ (".cond3").hide ();
		        $ (".searchd").hide ();
		        $.ajax (
		        {
		            url : '/subscribe/toProductClass.jspx',
		            type : 'post',
		            success : function (data)
		            {
		            	console.log(data)
			            $ ('.slistd').html (data);
		            }
		        });
	        }
	        $ (".seluld .wlid").find (".ico").click (function ()
	        {
		        $ (this).closest (".wlid").remove ();
	        });
	        
        }
        //拼div
        function dataHtml (id, text)
        {
	        var option = '';
	        if (text)
	        {
		        option += '<div class="wlid" va='+id+'>' + '<p>' + text + '</p>'
		                + '<p class="ico"><a href="javascript:;"></a></p>' + '</div>';
	        }
	        else
	        {
		        option = '<div class="wlid">' + '<p>Templecopy</p>' + '<p class="ico"><a href="javascript:;"></a></p>'
		                + '</div>';
	        }
	        
	        return option;
        }

        $ (function ()
        {
	        
	        //提交
	        $ ("#subbtn").click (function ()
	        {
		        var _isType = 0;
		        obj = $ ("[name=ckyq]");
		        proNo = [];
		        $.each (obj, function (i, data)
		        {
			        if ($ (data).attr("title") == "Type")
			        {
				        _isType = 1;
			        }
			        if ($ (data).attr("title") == "instrument")
			        {
				        _isType = 2;
			        }
			        if ($ (data).is(":checked"))
				        proNo.push ($ (data).val());
		        })
		        if(proNo.length==0){
		        	alert("请选择订阅信息");
		        	return;
		        }
		        type = $ ("[name=proType]");
		        proTypes = [];
		        $.each (type, function (i, info)
		        {
			        if ($(info).is(":checked")){
				        proTypes.push ($ (info).val());}
		        })
		        if (proTypes.length == 0)
		        {
			        alert ("请选择订阅信息类别");
			        return;
		        }
		        models = $ ("[name=model]");
		        infoModel = [];
		        $.each (models, function (i, data)
		        {
			        if ($ (data).is(":checked"))
			        {
			        	
			        	infoModel.push ($ (data).val());
			        }
		        })
		        if (infoModel.length == 0)
		        {
			        alert ("请选择订阅信息接收载体");
			        return;
		        }
		        $.ajax (
		        {
		            url : "/subscribe/addsubscribe.jspx",
		            data :
		            {
		                "proNo" : proNo,
		                "isType" : _isType,
		                "proType" : proTypes,
		                "rate" : $ ("[name=rate]").val (),
		                "model" : infoModel
		            },
		            traditional : true,
		            dataType : "json",
		            type : "post",
		            success : function (result)
		            {
			            alert (result.cont);
			            window.location.href = '/user/user';
		            }
		        });
		        /* 	$("#subscribeFrom").submit(); */
	        });
	        
	        $ (".seluld .wlid").find (".ico").click (function ()
	        {
		        $ (this).closest (".wlid").remove ();
		        alert ($ (this).parent ().attr ("id"));
	        });
	        $ ("input[name='ckyq']").click (function ()
	        {
		        if ($ (this).attr ("checked"))
		        {
			        $ (".seluld").append (dataHtml ($ (this).val (), $ (this).parent ().text ()));
			        $ (".ico").bind ('click', function ()
			        {
				        var id = $ (this).parent ().attr ("va");
				        $ ("[va=" + id + "]").attr ("checked", false);
				        $ (this).closest (".wlid").remove ();
				        
			        });
		        }
		        else
		        {
			        var id = $ (this).attr ("va");
			        $ (".wlid[va='" + id + "']").remove ();
		        }
	        });
	        //查询
	        $ ("#btnd").click (
	                function ()
	                {
		                $.ajax (
		                {
		                    url : "/subscribe/seachProInfo.jspx",
		                    data :
		                    {
			                    keyword : $ ("[name=keyword]").val ()
		                    },
		                    type : "post",
		                    success : function (result)
		                    {
			                    $ (".slistd").html ("<ul></ul>");
			                    $.each (result, function (i)
			                    {
				                    $ (".slistd").find ("ul").append (
				                            '<li><label> <input type="checkbox" name="ckyq" va='+result[i].id+''+
							' value='+result[i].id+'>'
				                                    + result[i].text + '' + '</label></li>');
			                    });
			                    $ (".slistd>ul").find ("[name=ckyq]").bind ('click', function ()
			                    {
				                    if ($ (this).attr ("checked"))
				                    {
					                    $ (".seluld").append (dataHtml ($ (this).val (), $ (this).parent ().text ()));
					                    $ (".ico").bind ('click', function ()
					                    {
						                    var id = $ (this).parent ().attr ("va");
						                    $ ("[va=" + id + "]").attr ("checked", false);
						                    $ (this).closest (".wlid").remove ();
						                    
					                    });
				                    }
				                    else
				                    {
					                    var id = $ (this).attr ("va");
					                    $ (".wlid[va='" + id + "']").remove ();
				                    }
			                    });
		                    }
		                })
	                });
        })
	</script>
</body>
</html>
