<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="/frontthemes/js/modelcollection.js"></script>
<!--下面两个是品牌选项框提示选择下拉选项的样式-->
<link rel="stylesheet" href="/statics/front/css/postbirdAlertBox.min.css" />
<script type="text/javascript" src="/statics/front/js/postbirdAlertBox.min.js"></script>
<div class="main" style="background-color: white;">
    <div class="easyui-panel" style="border-style: none;">
        <form id="addForm" method="post" class="validate">
            <table>
                <tr style="display:none">
                    <th>id</th>
                    <td><input class="input_text easyui-validatebox" type="text"  id="id"
                               name="id" data-options="" value="${item.id}" ></input>
                    </td>
                </tr>
                <tr style="display: none">
                    <th>行业分类</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_industry_class_coll"
                               name="mc_industry_class" data-options="required:false" value="${item.mc_industry_class}"></input>

                    </td>
                </tr>
                <tr>
                    <th>高校名称</th>
                    <td>
                        <input class="easyui-validatebox" id="name" name="name" style="width: 308px; height: 36px;" data-options="value:${item.name}"/>
                        <input type="hidden" id=name_fujian value="true"/><span class="rr_model" style="color: red"></span>
                    </td>
                </tr>
                <tr>
                    <th>实验室</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="laboratory_coll"
                               name="laboratory" data-options="required:false" value="${item.laboratory}"></input>
                    </td>
                </tr>
                <tr>
                    <th>专业</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_major_coll"
                               name="major" data-options="required:false" value="${major}"></input>
                    </td>
                </tr>
                <tr>
                    <th>老师姓名</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_teacher_coll"
                               name="teacher" data-options="required:false" value="${teacher}"></input>
                    </td>
                </tr>
                <tr>
                    <th>简历</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_resume_coll"
                               name="resume" data-options="required:false" value="${resume}"></input>
                    </td>
                </tr>
                <tr>
                    <th>研究方向</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="research_direction_coll"
                               name="research_direction" data-options="required:false" value="${item.research_direction}"></input>
                    </td>
                </tr>
                <tr>
                    <th>研究方向产品名称</th>
                    <td>
                        <!--<input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="major_product_coll"
                               name="major_product" data-options="required:false" value="${item.major_product}"></input>-->
                        <select style="width: 300px; line-height: 36px; height: 36px;"
                                name="major_product"
                                id="major_product_coll" /> </select>
                    </td>
                </tr>
                <tr id="multiple_list">
                    <th>仪器品牌</th>
                    <td >
                        <select style="width: 100px; height: 36px;"  class="easyui-combobox" name="brand" id="brand"></select>
                        仪器型号<input class="input_text easyui-validatebox" style="width: 80px;height: 18px" type="text"
                                   id="model" name="model" data-options="required:false" onblur="additional(0, null, this, null, null)"/>
                        仪器数量<input class="input_text easyui-validatebox" style="width: 80px;height: 18px" type="number" value="1"
                                   id="number" name="number" data-options="required:false" onblur="additional(0, null, null, this, null)"/>
                        仪器名称<select style="width: 180px; height: 36px;"  class="easyui-combotree" name="mc_productclass_name" id="mc_productclass_name"></select>
                        <a href="javascript:void(0)" class="button blueButton"
                           data-options="iconCls:'icon-add',plain:true" onclick="addInput()">再加一个型号</a>
                    </td>
                    <td><span class="rr_brand_and_model" style="color: red"></span></td>
                </tr>
                <!--<tr>
                    <th>常用仪器名称</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_productclass_coll"
                               name="mc_productclass" data-options="required:false" value="${item.mc_productclass}"></input><span style="color:red">* 多个请用逗号隔开</span>
                    </td>
                </tr>
                <tr>
                    <th>品牌型号</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_brand_coll"
                               name="mc_brand" data-options="required:false" value="${item.mc_brand}"></input>
                    </td>
                </tr>-->
                <tr>
                    <th>订阅内容</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="subscribe_content"
                               name="subscribe_content" data-options="required:false" value="${item.subscribeContent}"></input>
                    </td>
                </tr>

                <tr id="trr1" >
                    <th id="trr2">联系人</th>
                    <td>
                        <input style="width: 308px; height: 36px;"
                               class="easyui-combobox"
                               name="contact" data-options="valueField:'id',textField:'text',multiple:'true',separator:',',editable:false"
                               id="contact" required="required"/><span style="color:red">* 首个联系人为老师</span>
                    </td>
                </tr>
                <tr>
                    <th>责任人</th>
                    <td>
                        <input style="width: 308px; height: 36px;"
                               class="easyui-combobox"
                               url="/admin/mcMember/get_mcmember_names.jspx" name="blame" data-options="valueField:'id',textField:'text',editable:false"
                               id="blame" required="required"/>

                    </td>
                </tr>
                <tr>
                    <th>等级</th>
                    <td>
                        <select style="width: 308px; height: 36px;" id="grade" name="grade" class="input_text" required="required">
                            [#if item.grade=1]
                            <option value="1" selected="selected">一级</option>
                            <option value="2">二级</option>
                            <option value="3">三级</option>
                            <option value="4">四级</option>
                            <option value="5">五级</option>
                            <option value="6">六级</option>
                            <option value="7">七级</option>
                            <option value="8">八级</option>
                            <option value="9">九级</option>
                            [#else]
                            [#if item.grade=2]
                            <option value="1">一级</option>
                            <option value="2" selected="selected">二级</option>
                            <option value="3">三级</option>
                            <option value="4">四级</option>
                            <option value="5">五级</option>
                            <option value="6">六级</option>
                            <option value="7">七级</option>
                            <option value="8">八级</option>
                            <option value="9">九级</option>
                            [#else]
                            [#if item.grade=3]
                            <option value="1">一级</option>
                            <option value="2">二级</option>
                            <option value="3" selected="selected">三级</option>
                            <option value="4">四级</option>
                            <option value="5">五级</option>
                            <option value="6">六级</option>
                            <option value="7">七级</option>
                            <option value="8">八级</option>
                            <option value="9">九级</option>
                            [#else]
                            [#if item.grade=4]
                            <option value="1">一级</option>
                            <option value="2">二级</option>
                            <option value="3">三级</option>
                            <option value="4" selected="selected">四级</option>
                            <option value="5">五级</option>
                            <option value="6">六级</option>
                            <option value="7">七级</option>
                            <option value="8">八级</option>
                            <option value="9">九级</option>
                            [#else]
                            [#if item.grade=5]
                            <option value="1">一级</option>
                            <option value="2">二级</option>
                            <option value="3">三级</option>
                            <option value="4">四级</option>
                            <option value="5" selected="selected">五级</option>
                            <option value="6">六级</option>
                            <option value="7">七级</option>
                            <option value="8">八级</option>
                            <option value="9">九级</option>
                            [#else]
                            [#if item.grade=6]
                            <option value="1">一级</option>
                            <option value="2">二级</option>
                            <option value="3">三级</option>
                            <option value="4">四级</option>
                            <option value="5">五级</option>
                            <option value="6" selected="selected">六级</option>
                            <option value="7">七级</option>
                            <option value="8">八级</option>
                            <option value="9">九级</option>
                            [#else]
                            [#if item.grade=7]
                            <option value="1">一级</option>
                            <option value="2">二级</option>
                            <option value="3">三级</option>
                            <option value="4">四级</option>
                            <option value="5">五级</option>
                            <option value="6">六级</option>
                            <option value="7" selected="selected">七级</option>
                            <option value="8">八级</option>
                            <option value="9">九级</option>
                            [#else]
                            [#if item.grade=8]
                            <option value="1">一级</option>
                            <option value="2">二级</option>
                            <option value="3">三级</option>
                            <option value="4">四级</option>
                            <option value="5">五级</option>
                            <option value="6">六级</option>
                            <option value="7">七级</option>
                            <option value="8" selected="selected">八级</option>
                            <option value="9">九级</option>
                            [#else]
                            [#if item.grade=9]
                            <option value="1">一级</option>
                            <option value="2">二级</option>
                            <option value="3">三级</option>
                            <option value="4">四级</option>
                            <option value="5">五级</option>
                            <option value="6">六级</option>
                            <option value="7">七级</option>
                            <option value="8">八级</option>
                            <option value="9" selected="selected">九级</option>
                            [#else]
                            <option value="1" selected="selected">一级</option>
                            <option value="2">二级</option>
                            <option value="3">三级</option>
                            <option value="4">四级</option>
                            <option value="5">五级</option>
                            <option value="6">六级</option>
                            <option value="7">七级</option>
                            <option value="8">八级</option>
                            <option value="9">九级</option>
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                        </select>

                    </td>
                </tr>
                <tr>
                    <th>计量时间</th>
                    <td>
                        <select style="width: 308px; height: 36px;" id="measurement_time" name="measurement_time" class="input_text" required="required">
                            [#if item.measurement_time=1]
                            <option value="1" selected="selected">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=2]
                            <option value="1">一月</option>
                            <option value="2" selected="selected">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=3]
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3" selected="selected">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=4]
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4" selected="selected">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=5]
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5" selected="selected">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=6]
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6" selected="selected">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=7]
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7" selected="selected">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=8]
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8" selected="selected">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=9]
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9" selected="selected">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=10]
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10" selected="selected">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=11]
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11" selected="selected">十一月</option>
                            <option value="12">十二月</option>
                            [#else]
                            [#if item.measurement_time=12]
                            <option value="1">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12" selected="selected">十二月</option>
                            [#else]
                            <option value="1" selected="selected">一月</option>
                            <option value="2">二月</option>
                            <option value="3">三月</option>
                            <option value="4">四月</option>
                            <option value="5">五月</option>
                            <option value="6">六月</option>
                            <option value="7">七月</option>
                            <option value="8">八月</option>
                            <option value="9">九月</option>
                            <option value="10">十月</option>
                            <option value="11">十一月</option>
                            <option value="12">十二月</option>
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                            [/#if]
                        </select>

                    </td>
                </tr>
                <tr>
                    <th>订阅邮件</th>
                    <td>
                        <select style="width: 308px; height: 36px;" id="ckZt" name="ckZt" class="input_text" required="required">
                            [#if item.ckZt=1]
                            <option value="1" selected="selected">是</option>
                            <option value="2">否</option>
                            [#else]
                            [#if item.ckZt=2]
                            <option value="1">是</option>
                            <option value="2" selected="selected">否</option>
                            [#else]
                            <option value="1" selected="selected">是</option>
                            <option value="2">否</option>
                            [/#if]
                            [/#if]
                        </select>

                    </td>
                </tr>
                <tr>
                    <th>订阅周期</th>
                    <td>
                        <select style="width: 308px; height: 36px;" id="rate" name="rate" class="input_text" required="required">
                            [#if item.rate=1]
                            <option value="1" selected="selected">当天</option>
                            <option value="7">当周</option>
                            <option value="30">当月</option>
                            [#else]
                            [#if item.rate=7]
                            <option value="1">当天</option>
                            <option value="7" selected="selected">当周</option>
                            <option value="30">当月</option>
                            [#else]
                            [#if item.rate=30]
                            <option value="1">当天</option>
                            <option value="7">当周</option>
                            <option value="30" selected="selected">当月</option>
                            [#else]
                            <option value="1">当天</option>
                            <option value="7">当周</option>
                            <option value="30" selected="selected">当月</option>
                            [/#if]
                            [/#if]
                            [/#if]
                        </select>

                    </td>
                </tr>
                <tr>
                    <th>介绍人</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_introducer_coll"
                               name="mc_introducer" data-options="required:false" value="${item.introducer}"></input>
                    </td>
                </tr>
                <tr>
                    <th>备注</th>
                    <td>
                        <input style="width: 300px; height: 21px;" class="input_text easyui-validatebox" type="text" id="mc_remark_coll"
                               name="mc_remark" data-options="required:false" value="${item.remark}"></input>
                    </td>
                </tr>
            </table>
            <input type="button"   class="input_text2 easyui-validatebox"   value="添加高校"  onclick="appendmccompanyname2()" style="left: 550px;top: 58px;position: absolute;"/>
            <input type="button"   class="input_text2 easyui-validatebox"   value="添加常用联系人"  onclick="appendcontact(id,'${item.name}')" style="left: 550px;top: 470px;position: absolute;"/>
            <input type="button"   class="input_text2 easyui-validatebox"   value="添加责任人"  onclick="appendmcmember()" style="left: 550px;top: 515px;position: absolute;"/>
        </form>
    </div>
</div>

<script type="text/javascript">
    $('#major_product_coll').combotree({
        width:300,
        method:'get',
        onlyLeafCheck:true,
        url: '/industryClass/combotreeData.json',
        multiple: true,
        onLoadSuccess: function (e) {
            $('#major_product_coll').combotree('setValues',"${item.major_product}".split(','))
        }
    });

    //下拉树实现自定义查询效果
    $('#name').combobox({
        filter: function(q, row){
            var opts = $(this).combobox('options');
            return row[opts.textField].indexOf(q) >= 0;//这里改成>=即可在任意地方匹配
        }
    });

    $('#contact').combobox({
        //url: '/admin/mcContacts/get_mcmember_names.jspx',
        url: '/admin/mcContacts/get_mcmember_names.jspx?mc_company_id='+'${item.name}',
        onLoadSuccess:function(node,data){
            if('${item.contact}' != ''  && $("#name_fujian").val() == 'true' ){
                var da='${item.contact}';
                var ary =da.split(",");
                var a = new Array();
                $.each(ary,function(i,item){//因后台取出的值是字符串，combotree将字符串组作为一个整体，故需将字符串按，截取并重新放入array数组。组成combotree识别的[a,b,c]模式（该步骤是获取后台的主营产品品牌等分类数组，使combotree选中已经选中的值）
                    a[i] = item;
                })
                $('#contact').combobox('setValues', a);
            }
        }
    });
    $('#blame').combobox({
        url: '/admin/mcMember/get_mcmember_names.jspx',
        onLoadSuccess:function(node,data){
            if('${item.blame}' != ''){
                var da='${item.blame}';
                var ary =da.split(",");
                var a = new Array();
                $.each(ary,function(i,item){//因后台取出的值是字符串，combotree将字符串组作为一个整体，故需将字符串按，截取并重新放入array数组。组成combotree识别的[a,b,c]模式（该步骤是获取后台的主营产品品牌等分类数组，使combotree选中已经选中的值）
                    a[i] = item;
                })
                $('#blame').combobox('setValues', a);
            }
        }
    });

    var condition_company=true;
    $("#name").combobox({
        required:true,
        valueField:'id',
        textField:'text',
        editable:true,
        url:'/admin/mcCompanyName/get_mcmember_names.jspx',
        onSelect:function(node){
            $.ajax({
                url:"/admin/ModelCollection/register.jspx",
                data:{name:node.id,edit_name:'${item.name}'},
                dataType:"json",
                type:"post",
                success:function(msg){
                    if(msg.cont == 'false'){
                        $(".rr_model").text('数据已存在，请修改！');
                        condition_company=false;
                        return false;
                    }
                    if(msg.cont == 'true'){
                        $(".rr_model").text('');
                        condition_company=true;
                        return true;
                    }
                },
                error:function(){
                    alert("网络异常,请重试!");
                    return false;
                }
            });

            $("#contact").combobox('clear');
            $("#name_fujian").val('false');
            var url ='/admin/mcContacts/get_mcmember_names.jspx?mc_company_id='+node.id;
            $("#contact").combobox('reload',url);//input框中有树方法

        }
    });
</script>
